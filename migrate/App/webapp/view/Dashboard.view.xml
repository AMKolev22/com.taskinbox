<mvc:View
    controllerName="App.controller.Dashboard"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    displayBlock="true"
    height="100%"
    busyIndicatorDelay="0"
>
    <SplitApp
        id="dashboardSplitApp"
        initialMaster="masterPage"
        initialDetail="detailPage"
    >
        <masterPages>
            <Page id="masterPage">
                <content>
                    <core:Fragment
                        fragmentName="App.view.fragments.Sidebar"
                        type="XML"
                    />
                </content>
            </Page>
        </masterPages>
        <detailPages>
            <Page
                id="detailPage"
                title="Task Inbox"
            >
                <content>
                    <VBox
                        class="sapUiMediumMarginTop"
                        height="auto"
                    >
                        <Panel
                            id="statsPanel"
                            headerText="Overview"
                            class="sapUiHideOnPhone sapUiHideOnTablet"
                            width="45%"
                        >
                            <content>
                                <FlexBox
                                    direction="{device>/system/phone ? 'Column' : 'Row'}"
                                    justifyContent="SpaceBetween"
                                    alignItems="Center"
                                    class="sapUiMediumMargin"
                                    wrap="{= ${device>/system/phone} ? 'NoWrap' : 'Wrap' }"
                                    items="{stats>/taskStats}"
                                >
                                    <items>
                                        <FlexBox
                                            direction="Column"
                                            alignItems="Center"
                                        >
                                            <Text
                                                text="{stats>value}"
                                                class="sapUiLargeText sapUiTextBold"
                                            />
                                            <Label text="{stats>label}" />
                                        </FlexBox>
                                    </items>
                                </FlexBox>
                            </content>
                        </Panel>
                        <Panel
                            id="statsPanelDesktop"
                            headerText="Overview"
                            class="sapUiHideOnDesktop"
                        >
                            <content>
                                <FlexBox
                                    direction="{device>/system/phone ? 'Column' : 'Row'}"
                                    justifyContent="SpaceBetween"
                                    alignItems="Center"
                                    class="sapUiMediumMargin"
                                    wrap="{= ${device>/system/phone} ? 'NoWrap' : 'Wrap' }"
                                    items="{stats>/taskStats}"
                                >
                                    <items>
                                        <FlexBox
                                            direction="Column"
                                            alignItems="Center"
                                        >
                                            <Text
                                                text="{stats>value}"
                                                class="sapUiLargeText sapUiTextBold"
                                            />
                                            <Label text="{stats>label}" />
                                        </FlexBox>
                                    </items>
                                </FlexBox>
                            </content>
                        </Panel>
                        <Panel
                            id="controlsPanel"
                            class="sapUiMediumMarginTop"
                            headerText="Filter Tasks"
                        >
                            <content>
                                <VBox class="sapUiSmallMarginTop">
                                    <SearchField
                                        id="searchField"
                                        placeholder="Search..."
                                        width="45%"
                                        class="sapUiSmallMarginBottom"
                                        liveChange="onSearchFieldChange"
                                    />
                                    <FlexBox
                                        direction="{device>/system/phone ? 'Column' : 'Row'}"
                                        alignItems="{device>/system/phone ? 'Stretch' : 'End'}"
                                        height="auto"
                                        wrap="{= ${device>/system/phone} ? noWrap : Wrap }"
                                    >
                                        <VBox class="sapUiSmallMarginEnd sapUiSmallMarginBottom">
                                            <Label
                                                text="Type:"
                                                class="sapUiTinyMarginBottom"
                                            />
                                            <Select
                                                id="typeFilter"
                                                width="{device>/system/phone ? '100%' : '150px'}"
                                                change="onTypeSelect"
                                            >
                                                <core:Item
                                                    key=""
                                                    text="All Types"
                                                />
                                                <core:Item
                                                    key="VACATION"
                                                    text="Vacation"
                                                />
                                                <core:Item
                                                    key="EQUIPMENT"
                                                    text="Equipment"
                                                />
                                                <core:Item
                                                    key="TRAVEL"
                                                    text="Travel"
                                                />
                                            </Select>
                                        </VBox>
                                        <VBox
                                            class="sapUiSmallMarginEnd sapUiSmallMarginBottom"
                                            height="50%"
                                        >
                                            <Label
                                                text="Priority:"
                                                class="sapUiTinyMarginBottom"
                                            />
                                            <Select
                                                id="priorityFilter"
                                                width="{device>/system/phone ? '100%' : '150px'}"
                                                change="onPrioritySelect"
                                            >
                                                <core:Item
                                                    key=""
                                                    text="All Priorities"
                                                />
                                                <core:Item
                                                    key="LOW"
                                                    text="Low"
                                                />
                                                <core:Item
                                                    key="MEDIUM"
                                                    text="Medium"
                                                />
                                                <core:Item
                                                    key="HIGH"
                                                    text="High"
                                                />
                                                <core:Item
                                                    key="URGENT"
                                                    text="Urgent"
                                                />
                                            </Select>
                                        </VBox>
                                    </FlexBox>
                                </VBox>
                            </content>
                        </Panel>
                        <Panel
                            id="tasksPanel"
                            headerText="Pending Tasks"
                            class="sapUiMediumMarginTop"
                            height="100%"
                        >
                            <content>
                                <Table
                                    id="tasksTable"
                                    fixedLayout="false"
                                    alternateRowColors="true"
                                    class="sapUiSizeCompact"
                                    visibleRowCountMode="Auto"
                                    items="{/vacationRequests}"
                                >
                                    <columns>
                                        <Column
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                        >
                                            <Text text="Type" />
                                        </Column>
                                        <Column
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                        >
                                            <Text text="Title" />
                                        </Column>
                                        <Column>
                                            <Text text="Priority" />
                                        </Column>
                                        <Column>
                                            <Text text="Employee" />
                                        </Column>
                                        <Column
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                        >
                                            <Text text="Due Date" />
                                        </Column>
                                        <Column
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                        >
                                            <Text text="Created" />
                                        </Column>
                                        <Column
                                            minScreenWidth="Tablet"
                                            demandPopin="true"
                                        >
                                            <Text text="Amount" />
                                        </Column>
                                        <Column>
                                            <Text text="Actions" />
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <ObjectStatus
                                                text="{type}"
                                                state="{typeState}"
                                            />
                                            <Text
                                                text="{title}"
                                                class="sapUiTextBold"
                                            />
                                            <ObjectStatus
                                                text="{priority}"
                                                state="{priorityState}"
                                            />
                                            <VBox>
                                                <Text
                                                    text="{employee/name}"
                                                    class="sapUiTextBold"
                                                />
                                                <Text
                                                    text="{employee/email}"
                                                    class="sapUiTextSmall"
                                                />
                                            </VBox>
                                            <Text text="{startDate}" />
                                            <Text text="{requestDate}" />
                                            <Text text="{duration}" />
                                            <HBox>
                                                <Button
                                                    icon="sap-icon://accept"
                                                    tooltip="Approve"
                                                    class="sapUiTinyMarginEnd"
                                                    press="onApprove"
                                                />
                                                <Button
                                                    icon="sap-icon://decline"
                                                    tooltip="Decline"
                                                    class="sapUiTinyMarginEnd"
                                                    press="onDecline"
                                                />
                                                <Button
                                                    icon="sap-icon://forward"
                                                    tooltip="Forward"
                                                    press="onForward"
                                                />
                                            </HBox>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </content>
                        </Panel>
                    </VBox>
                </content>
            </Page>
        </detailPages>
    </SplitApp>
</mvc:View>